



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/my-notes/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/my-notes/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="å­¦ä¹ ç¬”è®°" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="å­¦ä¹ ç¬”è®°" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="å­¦ä¹ ç¬”è®°" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/my-notes/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="Vueç¬”è®°" />


<link rel="canonical" href="http://example.com/2018/05/25/vue/4/">



  <title>
Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile) |
hee note = å­¦ä¹ ç¬”è®°</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile)
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2018-05-25 10:14:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2018-05-25T10:14:00+08:00">2018-05-25</time>
  </span>
  <span class="item" title="æœ¬æ–‡å­—æ•°">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">æœ¬æ–‡å­—æ•°</span>
    <span>23k</span>
    <span class="text">å­—</span>
  </span>
  <span class="item" title="é˜…è¯»æ—¶é•¿">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">é˜…è¯»æ—¶é•¿</span>
    <span>21 åˆ†é’Ÿ</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/my-notes/" rel="start">hee note</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?587484"></li>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?602971"></li>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?364892"></li>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?493156"></li>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?880002"></li>
          <li class="item" data-background-image="https://api.ouyangqiqi.cn/dm/img-webp.php?355802"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/my-notes/">é¦–é¡µ</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://example.com/2018/05/25/vue/4/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/my-notes/images/head.jpeg">
    <meta itemprop="name" content="lokve">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="å­¦ä¹ ç¬”è®°">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpdXRhby92dWUyLjAtc291cmNlL2Jsb2IvYmU0YWM3NzVlMjZlZmFlN2I2NGU1MjU0ZTIzYTk3ZDUwYTllODgwYy9jb21waWxlJUU2JUE2JTgyJUU4JUJGJUIwLm1k">å‚è€ƒäº†çš„æ–‡ç« </span></p>
<p>ä»è¿™é‡Œå¼€å§‹æˆ‘ä¼šå°½å¯èƒ½çš„æŠŠæºç é‡Œæ‰€æœ‰çš„ <code>if</code>  æƒ…å†µè€ƒè™‘è¿›å»ï¼Œè¿˜æ˜¯ä»¥ä¸€ä¸ªç®€å•ä¾‹å­å¼€å§‹ï¼Œä¹‹åä¼šä¸æ–­çš„æŠŠè¿™ä¸ªä¾‹å­è¡¥å……å®Œæ•´ï¼Œä»¥å®Œæˆå¯¹æ¯ä¸€è¡Œçš„è§£è¯»</p>
<h2 id="å¼€å§‹"><a class="markdownIt-Anchor" href="#å¼€å§‹">#</a> å¼€å§‹</h2>
<p>æ¨¡æ¿ç¼–è¯‘åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šç”Ÿæˆ astã€ä¼˜åŒ–é™æ€å†…å®¹ã€ç”Ÿæˆ render</p>
<p>ä»¥ä¸‹é¢ä»£ç å¼€å§‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">  &lt;p&gt;&#123;&#123;message&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;../dist/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  var vm = new Vue(&#123;</span><br><span class="line">    el: &#x27;#app&#x27;,</span><br><span class="line">    data: &#123;</span><br><span class="line">      message: &#x27;ç¬¬ä¸€ä¸ªvueå®ä¾‹&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h2 id="æ­£åˆ™è¡¥å……"><a class="markdownIt-Anchor" href="#æ­£åˆ™è¡¥å……">#</a> æ­£åˆ™è¡¥å……</h2>
<p>è¿™é‡Œç”¨åˆ°äº†å¾ˆå¤šçš„æ­£åˆ™åˆ¤æ–­ï¼Œå¯¹äºä¸€äº›æ¯”è¾ƒå¤æ‚çš„ä¸æ¸…æ¥šçš„åœ¨è¿™é‡Œè¿›è¡Œè¯´æ˜ (è¶…çš„<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpdXRhby92dWUyLjAtc291cmNlL2Jsb2IvYmU0YWM3NzVlMjZlZmFlN2I2NGU1MjU0ZTIzYTk3ZDUwYTllODgwYy9jb21waWxlJUUyJTgwJTk0JUUyJTgwJTk0JUU3JTk0JTlGJUU2JTg4JTkwYXN0Lm1k">å‚è€ƒæ–‡ç« </span>)</p>
<p>ä»£ç ç‰‡æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">while (</span><br><span class="line">  !endTag.test(rest) &amp;&amp;</span><br><span class="line">  !startTagOpen.test(rest) &amp;&amp;</span><br><span class="line">  !comment.test(rest) &amp;&amp;</span><br><span class="line">  !conditionalComment.test(rest)</span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>endTag = /<sup>&lt;/((?:[a-zA-Z_][\w-.]_ğŸ˜ƒ?[a-zA-Z_][\w-.]_)[</sup>&gt;]*&gt;/<br>
endTag æ˜¯åŒ¹é…åŒæ ‡ç­¾çš„ç»“æŸæ ‡ç­¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;/div&gt;&#x27;.match(endTag)</span><br><span class="line">// [&quot;&lt;/div&gt;&quot;, &quot;div&quot;, index: 0, input: &quot;&lt;/div&gt;&quot;]</span><br><span class="line"></span><br><span class="line">&#x27;&lt;/div    &gt;&#x27;.match(endTag)</span><br><span class="line">// [&quot;&lt;/div    &gt;&quot;, &quot;div&quot;, index: 0, input: &quot;&lt;/div    &gt;&quot;]</span><br><span class="line"></span><br><span class="line">&#x27; &lt;/div    &gt;&#x27;.match(endTag)</span><br><span class="line">// null</span><br></pre></td></tr></table></figure>
<p>startTagOpen = /^&lt;((?:[a-zA-Z_][\w-.]<em>ğŸ˜ƒ?[a-zA-Z_][\w-.]</em>)/<br>
 åŒ¹é…å¼€å§‹æ ‡ç­¾</p>
<h2 id="compiletofunctions"><a class="markdownIt-Anchor" href="#compiletofunctions">#</a> compileToFunctions</h2>
<p>ä» <code>compileToFunctions</code>  å¼€å§‹ï¼Œè·¯å¾„ <code>/src/compiler/index.js</code> ,<br>
 é¦–å…ˆåœ¨ mount æ–¹æ³•é‡Œæœ‰ä½¿ç”¨åˆ° <code>compileToFunctions</code>  æ–¹æ³•ï¼Œä»–è¿”å›äº† render å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">const &#123; render, staticRenderFns &#125; = compileToFunctions(template, &#123;</span><br><span class="line">    shouldDecodeNewlines,</span><br><span class="line">    delimiters: options.delimiters</span><br><span class="line">&#125;, this)</span><br><span class="line"></span><br><span class="line">function compileToFunctions (</span><br><span class="line">    template: string, // htmlæ¨¡æ¿</span><br><span class="line">    options?: CompilerOptions, // ä¸Šé¢çš„å‚æ•°</span><br><span class="line">    vm?: Component // vue</span><br><span class="line">  ): CompiledFunctionResult &#123;</span><br><span class="line">    options = options || &#123;&#125;</span><br><span class="line"></span><br><span class="line">    /* istanbul ignore if */</span><br><span class="line">    if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">      // detect possible CSP restriction</span><br><span class="line">      try &#123;</span><br><span class="line">        new Function(&#x27;return 1&#x27;)</span><br><span class="line">      &#125; catch (e) &#123;</span><br><span class="line">        if (e.toString().match(/unsafe-eval|CSP/)) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            &#x27;It seems you are using the standalone build of Vue.js in an &#x27; +</span><br><span class="line">            &#x27;environment with Content Security Policy that prohibits unsafe-eval. &#x27; +</span><br><span class="line">            &#x27;The template compiler cannot work in this environment. Consider &#x27; +</span><br><span class="line">            &#x27;relaxing the policy to allow unsafe-eval or pre-compiling your &#x27; +</span><br><span class="line">            &#x27;templates into render functions.&#x27;</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // check cache</span><br><span class="line">    const key = options.delimiters</span><br><span class="line">      ? String(options.delimiters) + template</span><br><span class="line">      : template // keyæ˜¯æ¨¡æ¿html</span><br><span class="line">    if (functionCompileCache[key]) &#123; // åº”è¯¥æ˜¯ç¼“å­˜</span><br><span class="line">      return functionCompileCache[key]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // compile</span><br><span class="line">    const compiled = compile(template, options)</span><br><span class="line"></span><br><span class="line">    // check compilation errors/tips</span><br><span class="line">    if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">      if (compiled.errors &amp;&amp; compiled.errors.length) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          `Error compiling template:\n\n$&#123;template&#125;\n\n` +</span><br><span class="line">          compiled.errors.map(e =&gt; `- $&#123;e&#125;`).join(&#x27;\n&#x27;) + &#x27;\n&#x27;,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      if (compiled.tips &amp;&amp; compiled.tips.length) &#123;</span><br><span class="line">        compiled.tips.forEach(msg =&gt; tip(msg, vm))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // turn code into functions</span><br><span class="line">    const res = &#123;&#125;</span><br><span class="line">    const fnGenErrors = []</span><br><span class="line">    res.render = makeFunction(compiled.render, fnGenErrors)</span><br><span class="line">    const l = compiled.staticRenderFns.length</span><br><span class="line">    res.staticRenderFns = new Array(l)</span><br><span class="line">    for (let i = 0; i &lt; l; i++) &#123;</span><br><span class="line">      res.staticRenderFns[i] = makeFunction(compiled.staticRenderFns[i], fnGenErrors)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // check function generation errors.</span><br><span class="line">    // this should only happen if there is a bug in the compiler itself.</span><br><span class="line">    // mostly for codegen development use</span><br><span class="line">    /* istanbul ignore if */</span><br><span class="line">    if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">      if ((!compiled.errors || !compiled.errors.length) &amp;&amp; fnGenErrors.length) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          `Failed to generate render function:\n\n` +</span><br><span class="line">          fnGenErrors.map((&#123; err, code &#125;) =&gt; `$&#123;err.toString()&#125; in\n\n$&#123;code&#125;\n`).join(&#x27;\n&#x27;),</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return (functionCompileCache[key] = res)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“è¯´æ˜çœ‹ä¸Šé¢æ³¨é‡Š</p>
<p>è¿è¡Œåˆ° <code>compile</code> ï¼Œæˆ‘ä»¬è·Ÿç€è¿›å»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">function compile (</span><br><span class="line">    template: string,</span><br><span class="line">    options?: CompilerOptions</span><br><span class="line">  ): CompiledResult &#123;</span><br><span class="line">    // finalOptions.prototype = baseOption</span><br><span class="line">    const finalOptions = Object.create(baseOptions)</span><br><span class="line">    const errors = []</span><br><span class="line">    const tips = []</span><br><span class="line">    // å®šä¹‰äº†warnæ–¹æ³•</span><br><span class="line">    finalOptions.warn = (msg, tip) =&gt; &#123;</span><br><span class="line">      (tip ? tips : errors).push(msg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (options) &#123;</span><br><span class="line">      // merge custom modules</span><br><span class="line">      // åˆå¹¶è‡ªå®šä¹‰modules</span><br><span class="line">      // TODO è¿™é‡Œçš„optionsåº”è¯¥è‚¯å®šæ²¡æœ‰è¿™äº›å‚æ•°æ‰å¯¹å•Šï¼Ÿä¸‹åŒ</span><br><span class="line">      if (options.modules) &#123;</span><br><span class="line">        finalOptions.modules = (baseOptions.modules || []).concat(options.modules)</span><br><span class="line">      &#125;</span><br><span class="line">      // merge custom directives</span><br><span class="line">      // åˆå¹¶è‡ªå®šä¹‰directives</span><br><span class="line">      if (options.directives) &#123;</span><br><span class="line">        finalOptions.directives = extend(</span><br><span class="line">          Object.create(baseOptions.directives),</span><br><span class="line">          options.directives</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      // copy other options</span><br><span class="line">      // èµ‹å€¼ç»™finalOptions</span><br><span class="line">      for (const key in options) &#123;</span><br><span class="line">        if (key !== &#x27;modules&#x27; &amp;&amp; key !== &#x27;directives&#x27;) &#123;</span><br><span class="line">          finalOptions[key] = options[key]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æŠŠå‚æ•°å¸¦åˆ°baseCompile</span><br><span class="line">    const compiled = baseCompile(template, finalOptions)</span><br><span class="line">    if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">      errors.push.apply(errors, detectErrors(compiled.ast))</span><br><span class="line">    &#125;</span><br><span class="line">    compiled.errors = errors</span><br><span class="line">    compiled.tips = tips</span><br><span class="line">    return compiled</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å¥å°±å‡ºç°äº†ä½ç½®å˜é‡ï¼Œæ ¹æ® build/alias çš„å®šä¹‰ä»¥åŠ web-runtime-with-compiler.js é‡Œé¢çš„å¼•ç”¨ï¼Œå¯ä»¥å‘ç°åœ¨ <code>src/platforms/web/compiler/index.js</code>  é‡Œé¢ä½¿ç”¨äº† createCompiler æ–¹æ³•ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/* @flow */</span><br><span class="line"></span><br><span class="line">import &#123; isUnaryTag, canBeLeftOpenTag &#125; from &#x27;./util&#x27;</span><br><span class="line">import &#123; genStaticKeys &#125; from &#x27;shared/util&#x27;</span><br><span class="line">import &#123; createCompiler &#125; from &#x27;compiler/index&#x27;</span><br><span class="line"></span><br><span class="line">import modules from &#x27;./modules/index&#x27;</span><br><span class="line">import directives from &#x27;./directives/index&#x27;</span><br><span class="line"></span><br><span class="line">import &#123;</span><br><span class="line">  isPreTag,</span><br><span class="line">  mustUseProp,</span><br><span class="line">  isReservedTag,</span><br><span class="line">  getTagNamespace</span><br><span class="line">&#125; from &#x27;../util/index&#x27;</span><br><span class="line"></span><br><span class="line">export const baseOptions: CompilerOptions = &#123;</span><br><span class="line">  expectHTML: true,</span><br><span class="line">  modules,</span><br><span class="line">  directives,</span><br><span class="line">  isPreTag,</span><br><span class="line">  isUnaryTag,</span><br><span class="line">  mustUseProp,</span><br><span class="line">  canBeLeftOpenTag,</span><br><span class="line">  isReservedTag,</span><br><span class="line">  getTagNamespace,</span><br><span class="line">  staticKeys: genStaticKeys(modules)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123; compile, compileToFunctions &#125; = createCompiler(baseOptions)</span><br><span class="line">export &#123; compile, compileToFunctions &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç„¶å baseOptions å°±åœ¨è¿™é‡Œå®šä¹‰äº†ï¼Œå…·ä½“å‚æ•°åŠæ–¹æ³•ä¼šåœ¨ç”¨åˆ°çš„æ—¶å€™ç»†çœ‹</p>
<p>è¿è¡Œåˆ° <code>baseCompile</code> ï¼Œç„¶åè¿›å…¥ <code>parse</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function baseCompile (</span><br><span class="line">  template: string,</span><br><span class="line">  options: CompilerOptions</span><br><span class="line">): CompiledResult &#123;</span><br><span class="line">  const ast = parse(template.trim(), options)</span><br><span class="line">  optimize(ast, options)</span><br><span class="line">  const code = generate(ast, options)</span><br><span class="line">  return &#123;</span><br><span class="line">    ast,</span><br><span class="line">    render: code.render,</span><br><span class="line">    staticRenderFns: code.staticRenderFns</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>parse</code>  åœ¨ /src/compiler/parser/index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Convert HTML string to AST.</span><br><span class="line"> */</span><br><span class="line">export function parse (</span><br><span class="line">  template: string,</span><br><span class="line">  options: CompilerOptions</span><br><span class="line">): ASTElement | void &#123;</span><br><span class="line"></span><br><span class="line">  // warnå‡½æ•°</span><br><span class="line">  warn = options.warn || baseWarn</span><br><span class="line"></span><br><span class="line">  // è·å–å‘½åç©ºé—´ï¼Œsvgå’Œmath</span><br><span class="line">  platformGetTagNamespace = options.getTagNamespace || no</span><br><span class="line"></span><br><span class="line">  // éœ€è¦ä½¿ç”¨propsç»‘å®šçš„å±æ€§ï¼Œæ¯”å¦‚valueã€selectedç­‰</span><br><span class="line">  platformMustUseProp = options.mustUseProp || no</span><br><span class="line"></span><br><span class="line">  // æ˜¯å¦æ˜¯preæ ‡ç­¾</span><br><span class="line">  platformIsPreTag = options.isPreTag || no</span><br><span class="line"></span><br><span class="line">  // å–options.modulesé‡Œæœ‰preTransformNodeå‚æ•°çš„æ•°ç»„ï¼Œä¸‹åŒ</span><br><span class="line">  preTransforms = pluckModuleFunction(options.modules, &#x27;preTransformNode&#x27;)</span><br><span class="line">  transforms = pluckModuleFunction(options.modules, &#x27;transformNode&#x27;)</span><br><span class="line">  postTransforms = pluckModuleFunction(options.modules, &#x27;postTransformNode&#x27;)</span><br><span class="line">  delimiters = options.delimiters</span><br><span class="line"></span><br><span class="line">  const stack = []</span><br><span class="line">  const preserveWhitespace = options.preserveWhitespace !== false</span><br><span class="line">  let root</span><br><span class="line">  let currentParent</span><br><span class="line">  let inVPre = false</span><br><span class="line">  let inPre = false</span><br><span class="line">  let warned = false</span><br><span class="line"></span><br><span class="line">  function warnOnce (msg) &#123;</span><br><span class="line">    if (!warned) &#123;</span><br><span class="line">      warned = true</span><br><span class="line">      warn(msg)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function endPre (element) &#123;</span><br><span class="line">    // check pre state</span><br><span class="line">    if (element.pre) &#123;</span><br><span class="line">      inVPre = false</span><br><span class="line">    &#125;</span><br><span class="line">    if (platformIsPreTag(element.tag)) &#123;</span><br><span class="line">      inPre = false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  parseHTML(template, &#123;</span><br><span class="line">    warn,</span><br><span class="line">    expectHTML: options.expectHTML,</span><br><span class="line">    isUnaryTag: options.isUnaryTag,</span><br><span class="line">    canBeLeftOpenTag: options.canBeLeftOpenTag,</span><br><span class="line">    shouldDecodeNewlines: options.shouldDecodeNewlines,</span><br><span class="line">    start (tag, attrs, unary) &#123;</span><br><span class="line">      // check namespace.</span><br><span class="line">      // inherit parent ns if there is one</span><br><span class="line">      // ç¬¬ä¸€éè¿˜ä¸æ¸…æ¥šæ˜¯å•¥</span><br><span class="line">      const ns = (currentParent &amp;&amp; currentParent.ns) || platformGetTagNamespace(tag)</span><br><span class="line"></span><br><span class="line">      // handle IE svg bug</span><br><span class="line">      /* istanbul ignore if */</span><br><span class="line">      if (isIE &amp;&amp; ns === &#x27;svg&#x27;) &#123;</span><br><span class="line">        attrs = guardIESVGBug(attrs)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      const element: ASTElement = &#123;</span><br><span class="line">        type: 1,</span><br><span class="line">        tag,</span><br><span class="line">        attrsList: attrs,</span><br><span class="line">        attrsMap: makeAttrsMap(attrs), // æŠŠattrè½¬æ¢æˆå¯¹è±¡ï¼Œå¹¶ä¸”æ£€éªŒé‡å¤å±æ€§</span><br><span class="line">        parent: currentParent,</span><br><span class="line">        children: []</span><br><span class="line">      &#125;</span><br><span class="line">      if (ns) &#123;</span><br><span class="line">        element.ns = ns</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å¦‚æœæ ‡ç­¾æ˜¯styleå’Œscript</span><br><span class="line">      if (isForbiddenTag(element) &amp;&amp; !isServerRendering()) &#123;</span><br><span class="line">        element.forbidden = true</span><br><span class="line">        process.env.NODE_ENV !== &#x27;production&#x27; &amp;&amp; warn(</span><br><span class="line">          &#x27;Templates should only be responsible for mapping the state to the &#x27; +</span><br><span class="line">          &#x27;UI. Avoid placing tags with side-effects in your templates, such as &#x27; +</span><br><span class="line">          `&lt;$&#123;tag&#125;&gt;` + &#x27;, as they will not be parsed.&#x27;</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // apply pre-transforms</span><br><span class="line">      for (let i = 0; i &lt; preTransforms.length; i++) &#123;</span><br><span class="line">        preTransforms[i](element, options)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!inVPre) &#123;</span><br><span class="line">        processPre(element) // å¦‚æœæ ‡ç­¾æœ‰v-preï¼Œåˆ™element.pre = true</span><br><span class="line">        if (element.pre) &#123;</span><br><span class="line">          inVPre = true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      if (platformIsPreTag(element.tag)) &#123; // åˆ¤æ–­tagæ˜¯ä¸æ˜¯pre</span><br><span class="line">        inPre = true</span><br><span class="line">      &#125;</span><br><span class="line">      if (inVPre) &#123;</span><br><span class="line">        processRawAttrs(element)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        processFor(element) // v-for</span><br><span class="line">        processIf(element) // v-if</span><br><span class="line">        processOnce(element) // v-once element.once = true</span><br><span class="line">        processKey(element) // key element.key = i</span><br><span class="line"></span><br><span class="line">        // determine whether this is a plain element after</span><br><span class="line">        // removing structural attributes</span><br><span class="line">        // ä¸å­˜åœ¨å…¶ä»–å±æ€§çš„&#x27;çº¯&#x27;å…ƒç´ </span><br><span class="line">        element.plain = !element.key &amp;&amp; !attrs.length</span><br><span class="line"></span><br><span class="line">        processRef(element) // ref</span><br><span class="line">        processSlot(element) // slot</span><br><span class="line">        processComponent(element) // is</span><br><span class="line"></span><br><span class="line">        // transformsåŒ…å«äº†classå’Œstyleçš„å¤„ç†å‡½æ•°</span><br><span class="line">        // ç»™elementæ·»åŠ äº†staticClass(class)å’ŒclassBinding(:class||v-bind:class)å±æ€§</span><br><span class="line">        // ç»™elementæ·»åŠ äº†staticStyle(style)å’ŒstyleBinding(:style||v-bind:style)å±æ€§</span><br><span class="line">        for (let i = 0; i &lt; transforms.length; i++) &#123;</span><br><span class="line">          transforms[i](element, options)</span><br><span class="line">        &#125;</span><br><span class="line">        processAttrs(element) // å¤„ç†é™¤äº†ä¸Šé¢çš„å…¶ä»–å±æ€§</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      function checkRootConstraints (el) &#123;</span><br><span class="line">        if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">          // slotå’ŒtemplateæŠ¥é”™æç¤º</span><br><span class="line">          if (el.tag === &#x27;slot&#x27; || el.tag === &#x27;template&#x27;) &#123;</span><br><span class="line">            warnOnce(</span><br><span class="line">              `Cannot use &lt;$&#123;el.tag&#125;&gt; as component root element because it may ` +</span><br><span class="line">              &#x27;contain multiple nodes.&#x27;</span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">          // æ ¹èŠ‚ç‚¹ä¸èƒ½åŠ v-foræŠ¥é”™æç¤º</span><br><span class="line">          if (el.attrsMap.hasOwnProperty(&#x27;v-for&#x27;)) &#123;</span><br><span class="line">            warnOnce(</span><br><span class="line">              &#x27;Cannot use v-for on stateful component root element because &#x27; +</span><br><span class="line">              &#x27;it renders multiple elements.&#x27;</span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // tree management</span><br><span class="line">      if (!root) &#123; // ç¬¬ä¸€æ¬¡è¿›å…¥è¿™ä¸ªif</span><br><span class="line">        root = element</span><br><span class="line">        checkRootConstraints(root) // è§ä¸Šé¢å‡½æ•°</span><br><span class="line">      &#125; else if (!stack.length) &#123;</span><br><span class="line">        // allow root elements with v-if, v-else-if and v-else</span><br><span class="line">        if (root.if &amp;&amp; (element.elseif || element.else)) &#123;</span><br><span class="line">          checkRootConstraints(element)</span><br><span class="line">          addIfCondition(root, &#123;</span><br><span class="line">            exp: element.elseif,</span><br><span class="line">            block: element</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; else if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">          warnOnce(</span><br><span class="line">            `Component template should contain exactly one root element. ` +</span><br><span class="line">            `If you are using v-if on multiple elements, ` +</span><br><span class="line">            `use v-else-if to chain them instead.`</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      if (currentParent &amp;&amp; !element.forbidden) &#123; // ç¬¬ä¸€æ¬¡ä¸è¿›if</span><br><span class="line">        if (element.elseif || element.else) &#123;</span><br><span class="line">          processIfConditions(element, currentParent)</span><br><span class="line">        &#125; else if (element.slotScope) &#123; // scoped slot</span><br><span class="line">          currentParent.plain = false</span><br><span class="line">          const name = element.slotTarget || &#x27;&quot;default&quot;&#x27;</span><br><span class="line">          ;(currentParent.scopedSlots || (currentParent.scopedSlots = &#123;&#125;))[name] = element</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          currentParent.children.push(element)</span><br><span class="line">          element.parent = currentParent</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      if (!unary) &#123; // ä¸æ˜¯å•æ ‡ç­¾</span><br><span class="line">        currentParent = element</span><br><span class="line">        stack.push(element)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        endPre(element)</span><br><span class="line">      &#125;</span><br><span class="line">      // apply post-transforms</span><br><span class="line">      // ä¸çŸ¥é“æ˜¯å•¥</span><br><span class="line">      for (let i = 0; i &lt; postTransforms.length; i++) &#123;</span><br><span class="line">        postTransforms[i](element, options)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    end () &#123;</span><br><span class="line">      // remove trailing whitespace</span><br><span class="line">      const element = stack[stack.length - 1]</span><br><span class="line">      const lastNode = element.children[element.children.length - 1]</span><br><span class="line">      if (lastNode &amp;&amp; lastNode.type === 3 &amp;&amp; lastNode.text === &#x27; &#x27; &amp;&amp; !inPre) &#123;</span><br><span class="line">        element.children.pop()</span><br><span class="line">      &#125;</span><br><span class="line">      // pop stack åˆ é™¤æœ€è¿‘çš„ä¸€ä¸ªé—­åˆæ ‡ç­¾</span><br><span class="line">      stack.length -= 1</span><br><span class="line">      // currentParentå˜ä¸ºä¸Šä¸€å±‚èŠ‚ç‚¹</span><br><span class="line">      currentParent = stack[stack.length - 1]</span><br><span class="line">      // preåšç»“æŸå¤„ç†</span><br><span class="line">      endPre(element)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    chars (text: string) &#123;</span><br><span class="line">      if (!currentParent) &#123; // è¿™é‡Œå¯èƒ½æ˜¯Component templateå¿…é¡»è¦æœ‰ä¸ªæ ¹èŠ‚ç‚¹</span><br><span class="line">        if (process.env.NODE_ENV !== &#x27;production&#x27;) &#123;</span><br><span class="line">          if (text === template) &#123;</span><br><span class="line">            warnOnce(</span><br><span class="line">              &#x27;Component template requires a root element, rather than just text.&#x27;</span><br><span class="line">            )</span><br><span class="line">          &#125; else if ((text = text.trim())) &#123;</span><br><span class="line">            warnOnce(</span><br><span class="line">              `text &quot;$&#123;text&#125;&quot; outside root element will be ignored.`</span><br><span class="line">            )</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      // IE textarea placeholder bug</span><br><span class="line">      // ieæ‰æœ‰çš„bugï¼Œç°åœ¨æ²¡æ¡ä»¶æµ‹è¯•</span><br><span class="line">      /* istanbul ignore if */</span><br><span class="line">      if (isIE &amp;&amp;</span><br><span class="line">          currentParent.tag === &#x27;textarea&#x27; &amp;&amp;</span><br><span class="line">          currentParent.attrsMap.placeholder === text) &#123;</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      const children = currentParent.children</span><br><span class="line">      text = inPre || text.trim() // preé‡Œé¢æˆ–è€…å­˜åœ¨é™æ€æ–‡æœ¬</span><br><span class="line">        ? decodeHTMLCached(text) // textå¤„ç†,å–äº†textContentçš„å€¼ï¼Œåœ¨chromeæŠŠ&amp;lt;è½¬ä¸ºäº†&lt;</span><br><span class="line">        // only preserve whitespace if its not right after a starting tag</span><br><span class="line">        : preserveWhitespace &amp;&amp; children.length ? &#x27; &#x27; : &#x27;&#x27;</span><br><span class="line">      if (text) &#123;</span><br><span class="line">        let expression</span><br><span class="line">        if (!inVPre &amp;&amp; text !== &#x27; &#x27; &amp;&amp; (expression = parseText(text, delimiters))) &#123; // åˆ¤æ–­æ˜¯ä¸æ˜¯&#123;&#123;&#125;&#125;è¡¨è¾¾å¼, å¹¶æå–è¡¨è¾¾å¼ä¸ºrenderå‡½æ•°</span><br><span class="line">          children.push(&#123;</span><br><span class="line">            type: 2,</span><br><span class="line">            expression,</span><br><span class="line">            text</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; else if (text !== &#x27; &#x27; || !children.length || children[children.length - 1].text !== &#x27; &#x27;) &#123; // çº¯ç²¹çš„é™æ€æ–‡æœ¬ã€çˆ¶èŠ‚ç‚¹v-pre|preã€</span><br><span class="line">          children.push(&#123;</span><br><span class="line">            type: 3,</span><br><span class="line">            text</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  return root</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåˆ° <code>parseHTML</code> , ç»§ç»­è·Ÿè¿›</p>
<p>æ–‡ä»¶åœ¨ src/compiler/parser/html-parser.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line">export function parseHTML (html, options) &#123;</span><br><span class="line">  const stack = [] // ä¸€äº›èµ‹å€¼æ“ä½œ</span><br><span class="line">  const expectHTML = options.expectHTML</span><br><span class="line">  const isUnaryTag = options.isUnaryTag || no</span><br><span class="line">  const canBeLeftOpenTag = options.canBeLeftOpenTag || no</span><br><span class="line">  let index = 0</span><br><span class="line">  let last, lastTag</span><br><span class="line">  while (html) &#123; // å¾ªç¯templateæ¨¡æ¿</span><br><span class="line">    last = html</span><br><span class="line"></span><br><span class="line">    // Make sure we&#x27;re not in a plaintext content element like script/style</span><br><span class="line">    // ä¸æ˜¯script,style,textareaä¸­çš„ä¸€ä¸ª</span><br><span class="line">    if (!lastTag || !isPlainTextElement(lastTag)) &#123;</span><br><span class="line">      let textEnd = html.indexOf(&#x27;&lt;&#x27;)</span><br><span class="line">      if (textEnd === 0) &#123;</span><br><span class="line"></span><br><span class="line">        // Comment: æ˜¯ä¸æ˜¯æ³¨é‡Š</span><br><span class="line">        // æ³¨é‡Šç›´æ¥æˆªå–ä¸åšé¢å¤–å¤„ç†</span><br><span class="line">        if (comment.test(html)) &#123;</span><br><span class="line">          const commentEnd = html.indexOf(&#x27;--&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">          if (commentEnd &gt;= 0) &#123;</span><br><span class="line">            advance(commentEnd + 3)</span><br><span class="line">            continue</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // http://en.wikipedia.org/wiki/Conditional_comment#Downlevel-revealed_conditional_comment</span><br><span class="line">        // çœ‹é“¾æ¥</span><br><span class="line">        if (conditionalComment.test(html)) &#123;</span><br><span class="line">          const conditionalEnd = html.indexOf(&#x27;]&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">          if (conditionalEnd &gt;= 0) &#123;</span><br><span class="line">            advance(conditionalEnd + 2)</span><br><span class="line">            continue</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Doctype:</span><br><span class="line">        const doctypeMatch = html.match(doctype)</span><br><span class="line">        if (doctypeMatch) &#123;</span><br><span class="line">          advance(doctypeMatch[0].length)</span><br><span class="line">          continue</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // End tag: æœ«å°¾æ ‡ç­¾</span><br><span class="line">        const endTagMatch = html.match(endTag)</span><br><span class="line">        if (endTagMatch) &#123;</span><br><span class="line">          const curIndex = index</span><br><span class="line">          advance(endTagMatch[0].length)</span><br><span class="line">          parseEndTag(endTagMatch[1], curIndex, index)</span><br><span class="line">          continue</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Start tag: å¼€å§‹æ ‡ç­¾</span><br><span class="line">        const startTagMatch = parseStartTag()</span><br><span class="line">        if (startTagMatch) &#123;</span><br><span class="line">          handleStartTag(startTagMatch)</span><br><span class="line">          continue</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      let text, rest, next</span><br><span class="line">      if (textEnd &gt;= 0) &#123; // ç¬¬äºŒæ¬¡è¿›è¿™é‡Œ å»é™¤æ¢è¡Œç¬¦</span><br><span class="line">        rest = html.slice(textEnd)</span><br><span class="line">        while (</span><br><span class="line">          !endTag.test(rest) &amp;&amp; // ä¸æ˜¯ç»“æŸæ ‡ç­¾</span><br><span class="line">          !startTagOpen.test(rest) &amp;&amp; // ä¸æ˜¯å¼€å§‹æ ‡ç­¾</span><br><span class="line">          !comment.test(rest) &amp;&amp; // ä¸æ˜¯æ³¨é‡Š</span><br><span class="line">          !conditionalComment.test(rest) // ä¸æ˜¯![</span><br><span class="line">        ) &#123;</span><br><span class="line">          // &lt; in plain text, be forgiving and treat it as text</span><br><span class="line">          // &lt;å¯èƒ½ä¼šå­˜åœ¨æ–‡æœ¬ä¸­ï¼Œfds&quot;&lt;&quot;fasdf,ä½†åœ¨chromeé‡Œ&lt;ä¼šè¢«è½¬åŒ–ä¸º&amp;lt;</span><br><span class="line">          // ç›®å‰è¿˜ä¸æ¸…æ¥šæ€ä¹ˆè¿›è¿™ä¸ªæ¡ä»¶</span><br><span class="line">          // ä¸è¿‡è¿™é‡Œçš„æœ€ç»ˆç›®çš„è¿˜æ˜¯ä¸ºäº†æ‰¾åˆ°æœ€è¿‘çš„å¹¶ä¸”æ˜¯æ ‡ç­¾çš„&lt;</span><br><span class="line">          next = rest.indexOf(&#x27;&lt;&#x27;, 1)</span><br><span class="line">          if (next &lt; 0) break</span><br><span class="line">          textEnd += next</span><br><span class="line">          rest = html.slice(textEnd)</span><br><span class="line">        &#125;</span><br><span class="line">        text = html.substring(0, textEnd)</span><br><span class="line">        advance(textEnd)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (textEnd &lt; 0) &#123;</span><br><span class="line">        text = html</span><br><span class="line">        html = &#x27;&#x27;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (options.chars &amp;&amp; text) &#123; // æœ¬ä¾‹ç¬¬äºŒæ¬¡loopè¿›å…¥è¿™é‡Œ</span><br><span class="line">        options.chars(text)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      var stackedTag = lastTag.toLowerCase()</span><br><span class="line">      var reStackedTag = reCache[stackedTag] || (reCache[stackedTag] = new RegExp(&#x27;([\\s\\S]*?)(&lt;/&#x27; + stackedTag + &#x27;[^&gt;]*&gt;)&#x27;, &#x27;i&#x27;))</span><br><span class="line">      var endTagLength = 0</span><br><span class="line">      var rest = html.replace(reStackedTag, function (all, text, endTag) &#123;</span><br><span class="line">        endTagLength = endTag.length</span><br><span class="line">        if (!isPlainTextElement(stackedTag) &amp;&amp; stackedTag !== &#x27;noscript&#x27;) &#123;</span><br><span class="line">          text = text</span><br><span class="line">            .replace(/&lt;!--([\s\S]*?)--&gt;/g, &#x27;$1&#x27;)</span><br><span class="line">            .replace(/&lt;!\[CDATA\[([\s\S]*?)]]&gt;/g, &#x27;$1&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">        if (options.chars) &#123;</span><br><span class="line">          options.chars(text)</span><br><span class="line">        &#125;</span><br><span class="line">        return &#x27;&#x27;</span><br><span class="line">      &#125;)</span><br><span class="line">      index += html.length - rest.length</span><br><span class="line">      html = rest</span><br><span class="line">      parseEndTag(stackedTag, index - endTagLength, index)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (html === last) &#123;</span><br><span class="line">      options.chars &amp;&amp; options.chars(html)</span><br><span class="line">      if (process.env.NODE_ENV !== &#x27;production&#x27; &amp;&amp; !stack.length &amp;&amp; options.warn) &#123;</span><br><span class="line">        options.warn(`Mal-formatted tag at end of template: &quot;$&#123;html&#125;&quot;`)</span><br><span class="line">      &#125;</span><br><span class="line">      break</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Clean up any remaining tags</span><br><span class="line">  parseEndTag()</span><br><span class="line"></span><br><span class="line">  function advance (n) &#123;</span><br><span class="line">    index += n</span><br><span class="line">    html = html.substring(n)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function parseStartTag () &#123;</span><br><span class="line">    // matchåœ¨ä¸åŠ gçš„æ—¶å€™åŒexecæ–¹æ³•</span><br><span class="line">    // 0è¿”å›åŒ¹é…ï¼Œ1è¿”å›æ­£åˆ™æ‹¬å·é‡Œçš„åŒ¹é…</span><br><span class="line">    const start = html.match(startTagOpen)</span><br><span class="line">    if (start) &#123;</span><br><span class="line">      const match = &#123;</span><br><span class="line">        tagName: start[1],</span><br><span class="line">        attrs: [],</span><br><span class="line">        start: index</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // ç»™indexé‡æ–°èµ‹å€¼å¹¶ä¸”æˆªå–htmlæ¨¡æ¿</span><br><span class="line">      advance(start[0].length)</span><br><span class="line">      let end, attr</span><br><span class="line">      // endåŒ¹é…&gt;,attrè·å–æ ‡ç­¾çš„å±æ€§(id,classç­‰)</span><br><span class="line">      // attrå¹¶ä¸èƒ½ä¸€æ¬¡æ€§è·å–å…¨éƒ¨å±æ€§ï¼Œè€Œæ˜¯é€šè¿‡ä¸æ–­çš„éå†å’Œæˆªå–å­—ç¬¦çªœæ¯æ¬¡è·å–ä¸€ç»„å±æ€§</span><br><span class="line">      // è¿™ä¸ªåŒ¹é…æ­£åˆ™éœ€è¦ç ”ç©¶ä¸€ä¸‹</span><br><span class="line">      // /^\s*([^\s&quot;&#x27;&lt;&gt;\/=]+)(?:\s*((?:=))\s*(?:&quot;([^&quot;]*)&quot;+|&#x27;([^&#x27;]*)&#x27;+|([^\s&quot;&#x27;=&lt;&gt;`]+)))?/</span><br><span class="line">      // 3,4,5åˆ†åˆ«åŒ¹é…äº†id=&quot;app&quot;|id=&#x27;app&#x27;|id=app ä¸‰ç§å±æ€§ä¹¦å†™æ ¼å¼</span><br><span class="line">      // å½“åŒ¹é…åˆ°æœ«å°¾æ ‡ç­¾&gt;æ—¶è·³å‡ºå¾ªç¯</span><br><span class="line">      while (!(end = html.match(startTagClose)) &amp;&amp; (attr = html.match(attribute))) &#123;</span><br><span class="line">        advance(attr[0].length)</span><br><span class="line">        match.attrs.push(attr)</span><br><span class="line">      &#125;</span><br><span class="line">      if (end) &#123;</span><br><span class="line">        // å•æ ‡ç­¾æ–œæ </span><br><span class="line">        match.unarySlash = end[1]</span><br><span class="line">        advance(end[0].length)</span><br><span class="line">        match.end = index // æœ«å°¾index</span><br><span class="line">        return match</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function handleStartTag (match) &#123;</span><br><span class="line">    const tagName = match.tagName</span><br><span class="line">    const unarySlash = match.unarySlash</span><br><span class="line"></span><br><span class="line">    if (expectHTML) &#123;</span><br><span class="line">      // åˆ¤æ–­äº†på’Œ ä¸æ˜¯æ®µè½æ ‡ç­¾ (è¿™æ˜¯æ ‡ç­¾åµŒå¥—è§„èŒƒï¼Œå¯ä»¥è‡ªè¡Œæœç´¢)</span><br><span class="line">      if (lastTag === &#x27;p&#x27; &amp;&amp; isNonPhrasingTag(tagName)) &#123;</span><br><span class="line">        parseEndTag(lastTag)</span><br><span class="line">      &#125;</span><br><span class="line">      // å¯ä»¥ä¸é—­åˆçš„æ ‡ç­¾</span><br><span class="line">      if (canBeLeftOpenTag(tagName) &amp;&amp; lastTag === tagName) &#123;</span><br><span class="line">        parseEndTag(tagName)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æ˜¯å¦å•æ ‡ç­¾</span><br><span class="line">    const unary = isUnaryTag(tagName) || tagName === &#x27;html&#x27; &amp;&amp; lastTag === &#x27;head&#x27; || !!unarySlash</span><br><span class="line"></span><br><span class="line">    const l = match.attrs.length</span><br><span class="line">    const attrs = new Array(l)</span><br><span class="line">    for (let i = 0; i &lt; l; i++) &#123;</span><br><span class="line">      const args = match.attrs[i]</span><br><span class="line">      // hackish work around FF bug https://bugzilla.mozilla.org/show_bug.cgi?id=369778</span><br><span class="line">      if (IS_REGEX_CAPTURING_BROKEN &amp;&amp; args[0].indexOf(&#x27;&quot;&quot;&#x27;) === -1) &#123;</span><br><span class="line">        if (args[3] === &#x27;&#x27;) &#123; delete args[3] &#125;</span><br><span class="line">        if (args[4] === &#x27;&#x27;) &#123; delete args[4] &#125;</span><br><span class="line">        if (args[5] === &#x27;&#x27;) &#123; delete args[5] &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      const value = args[3] || args[4] || args[5] || &#x27;&#x27;</span><br><span class="line">      attrs[i] = &#123;</span><br><span class="line">        name: args[1],</span><br><span class="line">        value: decodeAttr(</span><br><span class="line">          value,</span><br><span class="line">          options.shouldDecodeNewlines // ieæ‰ä¼šå‡ºçš„é—®é¢˜ï¼Œå…¶ä»–æµè§ˆå™¨æ²¡æœ‰</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ä¸æ˜¯å•æ ‡ç­¾å°±æ·»åŠ åˆ°stackæ•°ç»„</span><br><span class="line">    if (!unary) &#123;</span><br><span class="line">      stack.push(&#123; tag: tagName, lowerCasedTag: tagName.toLowerCase(), attrs: attrs &#125;)</span><br><span class="line">      lastTag = tagName</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (options.start) &#123; // è¿™é‡Œè°ƒç”¨startæ–¹æ³•ï¼Œå›åˆ°startå‡½æ•°</span><br><span class="line">      options.start(tagName, attrs, unary, match.start, match.end)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function parseEndTag (tagName, start, end) &#123;</span><br><span class="line">    let pos, lowerCasedTagName</span><br><span class="line">    if (start == null) start = index</span><br><span class="line">    if (end == null) end = index</span><br><span class="line"></span><br><span class="line">    if (tagName) &#123;</span><br><span class="line">      lowerCasedTagName = tagName.toLowerCase()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Find the closest opened tag of the same type</span><br><span class="line">    // æ‰¾åˆ°æœ€è¿‘çš„ç›¸åŒæ ‡ç­¾</span><br><span class="line">    if (tagName) &#123;</span><br><span class="line">      for (pos = stack.length - 1; pos &gt;= 0; pos--) &#123;</span><br><span class="line">        if (stack[pos].lowerCasedTag === lowerCasedTagName) &#123;</span><br><span class="line">          break</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // If no tag name is provided, clean shop</span><br><span class="line">      pos = 0</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (pos &gt;= 0) &#123;</span><br><span class="line">      // Close all the open elements, up the stack</span><br><span class="line">      //</span><br><span class="line">      for (let i = stack.length - 1; i &gt;= pos; i--) &#123;</span><br><span class="line">        if (process.env.NODE_ENV !== &#x27;production&#x27; &amp;&amp;</span><br><span class="line">            (i &gt; pos || !tagName) &amp;&amp;</span><br><span class="line">            options.warn) &#123;</span><br><span class="line">          // æ²¡æœ‰å¯¹åº”çš„ç»“æŸæ ‡ç­¾</span><br><span class="line">          options.warn(</span><br><span class="line">            `tag &lt;$&#123;stack[i].tag&#125;&gt; has no matching end tag.`</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">        if (options.end) &#123;</span><br><span class="line">          options.end(stack[i].tag, start, end)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // Remove the open elements from the stack</span><br><span class="line">      // åˆ é™¤æœ€åä¸€ä¸ª</span><br><span class="line">      stack.length = pos</span><br><span class="line">      // lastTagå˜æˆæœ€åä¸€ä¸ª</span><br><span class="line">      lastTag = pos &amp;&amp; stack[pos - 1].tag</span><br><span class="line">    &#125; else if (lowerCasedTagName === &#x27;br&#x27;) &#123;</span><br><span class="line">      if (options.start) &#123;</span><br><span class="line">        options.start(tagName, [], true, start, end)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else if (lowerCasedTagName === &#x27;p&#x27;) &#123;</span><br><span class="line">      if (options.start) &#123;</span><br><span class="line">        options.start(tagName, [], false, start, end)</span><br><span class="line">      &#125;</span><br><span class="line">      if (options.end) &#123;</span><br><span class="line">        options.end(tagName, start, end)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>parse è¿”å›äº†ä¸€ä¸ª ast æ ‘ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½ç»è¿‡äº†æœ€åŸºç¡€çš„å¤„ç†ã€‚<br>
ç„¶åæ˜¯ <code>optimize(ast, options)</code></p>
<p><code>optimize</code>  åœ¨ src/compiler/optimizer.js</p>
<p><code>optimize</code>  çš„ä½œç”¨æ˜¯æ‰¾å‡º ast æ ‘é‡Œé¢çš„é™æ€èŠ‚ç‚¹ (èŠ‚ç‚¹æ˜¯é™æ€æ–‡æœ¬ä¹Ÿæ²¡æœ‰ v äº‹ä»¶ç»‘å®š) å’Œé™æ€æ ¹èŠ‚ç‚¹ (èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æ˜¯é™æ€èŠ‚ç‚¹)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Goal of the optimizer: walk the generated template AST tree</span><br><span class="line"> * and detect sub-trees that are purely static, i.e. parts of</span><br><span class="line"> * the DOM that never needs to change.</span><br><span class="line"> * æ‰¾å‡ºasté‡Œé¢çš„é™æ€èŠ‚ç‚¹ï¼Œç„¶åä¸éœ€è¦é‡å¤çš„å–å¤„ç†ä»–ä»¬(å› ä¸ºä»–ä»¬æ˜¯é™æ€çš„ä¸ä¼šæ”¹å˜çš„)</span><br><span class="line"> *</span><br><span class="line"> * Once we detect these sub-trees, we can:</span><br><span class="line"> *</span><br><span class="line"> * 1. Hoist them into constants, so that we no longer need to</span><br><span class="line"> *    create fresh nodes for them on each re-render;</span><br><span class="line"> * 2. Completely skip them in the patching process.</span><br><span class="line"> */</span><br><span class="line">export function optimize (root: ?ASTElement, options: CompilerOptions) &#123;</span><br><span class="line">  if (!root) return</span><br><span class="line">  isStaticKey = genStaticKeysCached(options.staticKeys || &#x27;&#x27;)</span><br><span class="line">  isPlatformReservedTag = options.isReservedTag || no</span><br><span class="line">  // first pass: mark all non-static nodes.</span><br><span class="line">  // æ ‡è®°èŠ‚ç‚¹æ˜¯å¦é™æ€</span><br><span class="line">  markStatic(root)</span><br><span class="line">  // second pass: mark static roots.</span><br><span class="line">  // æ ‡è®°æ˜¯å¦æ˜¯é™æ€æ ¹èŠ‚ç‚¹</span><br><span class="line">  markStaticRoots(root, false)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function markStatic (node: ASTNode) &#123;</span><br><span class="line">  node.static = isStatic(node)</span><br><span class="line">  if (node.type === 1) &#123;</span><br><span class="line">    // do not make component slot content static. this avoids</span><br><span class="line">    // 1. components not able to mutate slot nodes</span><br><span class="line">    // 2. static slot content fails for hot-reloading</span><br><span class="line">    if (</span><br><span class="line">      !isPlatformReservedTag(node.tag) &amp;&amp;</span><br><span class="line">      node.tag !== &#x27;slot&#x27; &amp;&amp;</span><br><span class="line">      node.attrsMap[&#x27;inline-template&#x27;] == null</span><br><span class="line">    ) &#123;</span><br><span class="line">      return</span><br><span class="line">    &#125;</span><br><span class="line">    for (let i = 0, l = node.children.length; i &lt; l; i++) &#123;</span><br><span class="line">      const child = node.children[i]</span><br><span class="line">      markStatic(child)</span><br><span class="line">      if (!child.static) &#123;</span><br><span class="line">        node.static = false</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function isStatic (node: ASTNode): boolean &#123;</span><br><span class="line">  if (node.type === 2) &#123; // expression æœ‰è¡¨è¾¾å¼å°±ä¸æ˜¯</span><br><span class="line">    return false</span><br><span class="line">  &#125;</span><br><span class="line">  if (node.type === 3) &#123; // text // æ–‡æœ¬å°±æ˜¯</span><br><span class="line">    return true</span><br><span class="line">  &#125;</span><br><span class="line">  return !!(node.pre || ( // v-preä¸åšç¼–è¯‘ï¼Œæ˜¯</span><br><span class="line">    !node.hasBindings &amp;&amp; // no dynamic bindings æ²¡æœ‰åŠ¨æ€ç»‘å®š</span><br><span class="line">    !node.if &amp;&amp; !node.for &amp;&amp; // not v-if or v-for or v-else</span><br><span class="line">    !isBuiltInTag(node.tag) &amp;&amp; // not a built-in</span><br><span class="line">    isPlatformReservedTag(node.tag) &amp;&amp; // not a component</span><br><span class="line">    !isDirectChildOfTemplateFor(node) &amp;&amp; // templateæ²¡æœ‰for</span><br><span class="line">    Object.keys(node).every(isStaticKey) // èŠ‚ç‚¹çš„å±æ€§åªèƒ½æ˜¯isStaticKeyé‡Œé¢é‚£å‡ ä¸ª</span><br><span class="line">  ))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function markStaticRoots (node: ASTNode, isInFor: boolean) &#123;</span><br><span class="line">  if (node.type === 1) &#123;</span><br><span class="line">    if (node.static || node.once) &#123;</span><br><span class="line">      node.staticInFor = isInFor</span><br><span class="line">    &#125;</span><br><span class="line">    // For a node to qualify as a static root, it should have children that</span><br><span class="line">    // are not just static text. Otherwise the cost of hoisting out will</span><br><span class="line">    // outweigh the benefits and it&#x27;s better off to just always render it fresh.</span><br><span class="line">    if (node.static &amp;&amp; node.children.length &amp;&amp; !( // è¯¥èŠ‚ç‚¹é™æ€</span><br><span class="line">      node.children.length === 1 &amp;&amp; // èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹</span><br><span class="line">      node.children[0].type === 3 // å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹</span><br><span class="line">    )) &#123;</span><br><span class="line">      node.staticRoot = true</span><br><span class="line">      return</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      node.staticRoot = false</span><br><span class="line">    &#125;</span><br><span class="line">    if (node.children) &#123; // æœ‰å¤šä¸ªå­èŠ‚ç‚¹å°±è¿›è¡Œå¾ªç¯é€’å½’åˆ¤æ–­</span><br><span class="line">      for (let i = 0, l = node.children.length; i &lt; l; i++) &#123;</span><br><span class="line">        markStaticRoots(node.children[i], isInFor || !!node.for)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (node.ifConditions) &#123;</span><br><span class="line">      walkThroughConditionsBlocks(node.ifConditions, isInFor)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/my-notes/tags/Vue%E7%AC%94%E8%AE%B0/" rel="tag"><i class="ic i-tag"></i> Vueç¬”è®°</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">æ›´æ–°äº</span>
    <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-01-10 14:46:33" itemprop="dateModified" datetime="2024-01-10T14:46:33+08:00">2024-01-10</time>
  </span>
  <span id="2018/05/25/vue/4/" class="item leancloud_visitors" data-flag-title="Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile)" title="é˜…è¯»æ¬¡æ•°">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">é˜…è¯»æ¬¡æ•°</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">æ¬¡</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> èµèµ</button>
  <p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/my-notes/images/wechatpay.png" alt="lokve å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div>
        <img data-src="/my-notes/images/alipay.png" alt="lokve æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
      
      <div>
        <img data-src="/my-notes/images/paypal.png" alt="lokve è´å®">
        <p>è´å®</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>lokve <i class="ic i-at"><em>@</em></i>å­¦ä¹ ç¬”è®°
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="http://example.com/2018/05/25/vue/4/" title="Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile)">http://example.com/2018/05/25/vue/4/</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/my-notes/2018/01/23/vue/3/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;api.ouyangqiqi.cn&#x2F;dm&#x2F;img-webp.php?79956" title="Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ3ï¼‰(Vueçš„åŒå‘æ•°æ®ç»‘å®š)">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ3ï¼‰(Vueçš„åŒå‘æ•°æ®ç»‘å®š)</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/my-notes/2018/06/07/vue/class/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;api.ouyangqiqi.cn&#x2F;dm&#x2F;img-webp.php?427086" title="Vueæºç é˜…è¯»ç¬”è®° (class,style)">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Vueæºç é˜…è¯»ç¬”è®° (class,style)</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text"> å¼€å§‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A5%E5%85%85"><span class="toc-number">2.</span> <span class="toc-text"> æ­£åˆ™è¡¥å……</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compiletofunctions"><span class="toc-number">3.</span> <span class="toc-text"> compileToFunctions</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="lokve"
      data-src="/my-notes/images/head.jpeg">
  <p class="name" itemprop="name">lokve</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/my-notes/archives/">
        <span class="count">89</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/my-notes/categories/">
        <span class="count">4</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/my-notes/tags/">
        <span class="count">13</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xva3Zl" title="https:&#x2F;&#x2F;github.com&#x2F;lokve"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/my-notes/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/my-notes/about/" rel="section"><i class="ic i-user"></i>å…³äº</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/my-notes/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

        
  <li class="item">
    <a href="/my-notes/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a>
  </li>

        
  <li class="item">
    <a href="/my-notes/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/my-notes/2018/01/23/vue/3/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/my-notes/2018/06/07/vue/class/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2018/06/07/vue/class/" title="Vueæºç é˜…è¯»ç¬”è®° (class,style)">Vueæºç é˜…è¯»ç¬”è®° (class,style)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2020/09/14/react-redux/Provider/" title="Provider">Provider</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2019/07/10/%E7%AE%97%E6%B3%95/01.%E6%8E%92%E5%BA%8F/" title="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/my-notes/categories/react/" title="åˆ†ç±»äº react">react</a>
</div>

    <span><a href="/my-notes/2020/09/08/react/fiber/" title="fiber">fiber</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2018/05/25/vue/4/" title="Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile)">Vueæºç é˜…è¯»ç¬”è®°ï¼ˆ4ï¼‰(compile)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/my-notes/categories/leetcode/" title="åˆ†ç±»äº leetcode">leetcode</a>
<i class="ic i-angle-right"></i>
<a href="/my-notes/categories/leetcode/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" title="åˆ†ç±»äº åŠ¨æ€è§„åˆ’">åŠ¨æ€è§„åˆ’</a>
</div>

    <span><a href="/my-notes/2024/01/30/leetcode/377.Combination%20Sum%20IV/index/" title="377.Combination Sum IV">377.Combination Sum IV</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2017/05/23/bue/5/" title="Bueæºç é˜…è¯»ç¬”è®°ï¼ˆ5ï¼‰">Bueæºç é˜…è¯»ç¬”è®°ï¼ˆ5ï¼‰</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/my-notes/categories/leetcode/" title="åˆ†ç±»äº leetcode">leetcode</a>
<i class="ic i-angle-right"></i>
<a href="/my-notes/categories/leetcode/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" title="åˆ†ç±»äº åŠ¨æ€è§„åˆ’">åŠ¨æ€è§„åˆ’</a>
</div>

    <span><a href="/my-notes/2024/01/24/leetcode/494.Target%20Sum/index/" title="494.Target Sum">494.Target Sum</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2019/06/14/js%E9%AB%98%E7%BA%A7/15.Canvas/" title="Canvas">Canvas</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/my-notes/2017/06/28/%E9%9A%8F%E8%AE%B0/2/" title="ä¸€äº›ç¬”è®°">ä¸€äº›ç¬”è®°</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">lokve @ hee note</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">394k å­—</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:59</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2018/05/25/vue/4/',
    favicon: {
      show: "ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",
      hide: "(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/my-notes/js/app.js?v=0.2.5"></script>




</body>
</html>
